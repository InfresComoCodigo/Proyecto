<?xml version="1.0" ?>
<testsuites disabled="0" errors="0" failures="25" tests="76" time="0.0">
	<testsuite disabled="0" errors="0" failures="25" name="terraform scan" skipped="1" tests="76" time="0">
		<properties>
			<property name="directory" value="['/app']"/>
			<property name="add_check" value="False"/>
			<property name="list" value="False"/>
			<property name="output" value="['junitxml']"/>
			<property name="output_file_path" value="/app/results.xml"/>
			<property name="output_bc_ids" value="False"/>
			<property name="include_all_checkov_policies" value="True"/>
			<property name="quiet" value="False"/>
			<property name="compact" value="False"/>
			<property name="framework" value="['all']"/>
			<property name="skip_framework" value="[]"/>
			<property name="run_all_external_checks" value="False"/>
			<property name="soft_fail" value="False"/>
			<property name="skip_results_upload" value="False"/>
			<property name="repo_id" value="cli_repo/app"/>
			<property name="branch" value="master"/>
			<property name="skip_download" value="False"/>
			<property name="use_enforcement_rules" value="False"/>
			<property name="external_modules_download_path" value=".external_modules"/>
			<property name="evaluate_variables" value="True"/>
			<property name="no_cert_verify" value="False"/>
			<property name="create_baseline" value="False"/>
			<property name="output_baseline_as_skipped" value="False"/>
			<property name="secrets_scan_file_type" value="[]"/>
			<property name="enable_secret_scan_all_files" value="False"/>
			<property name="block_list_secret_scan" value="[]"/>
			<property name="summary_position" value="top"/>
			<property name="skip_resources_without_violations" value="False"/>
			<property name="deep_analysis" value="False"/>
			<property name="no_fail_on_crash" value="False"/>
			<property name="mask" value="defaultdict(&lt;class 'set'&gt;, {})"/>
			<property name="scan_secrets_history" value="False"/>
			<property name="secrets_history_timeout" value="12h"/>
			<property name="custom_tool_name" value="Checkov"/>
		</properties>
		<testcase name="[NONE][CKV_AWS_356] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_358] Ensure AWS GitHub Actions OIDC authorization policies only allow safe claims and claim order" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_111] Ensure IAM policies does not allow write access without constraints" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_1] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_109] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_49] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_283] Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_110] Ensure IAM policies does not allow privilege escalation" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_107] Ensure IAM policies does not allow credentials exposure" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_108] Ensure IAM policies does not allow data exfiltration" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_356] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_358] Ensure AWS GitHub Actions OIDC authorization policies only allow safe claims and claim order" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_111] Ensure IAM policies does not allow write access without constraints" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_1] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_109] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_49] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_283] Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_110] Ensure IAM policies does not allow privilege escalation" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_107] Ensure IAM policies does not allow credentials exposure" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_108] Ensure IAM policies does not allow data exfiltration" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_role.lambda_role" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_role.lambda_role" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_role.lambda_role" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_role_policy.inline" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_role_policy.inline" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_cloudwatch_log_group.lambda_log_group" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_permission.apigw_invoke" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_permission.apigw_invoke" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_93] Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV_AWS_216] Ensure CloudFront distribution is enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV_AWS_68] CloudFront Distribution should have WAF enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV_AWS_305] Ensure CloudFront distribution has a default root object configured" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV_AWS_34] Ensure CloudFront distribution ViewerProtocolPolicy is set to HTTPS" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV_AWS_175] Ensure WAF has associated rules" classname="/modules/edge/waf/main.tf.module.waf.aws_wafv2_web_acl.this" file="/modules/edge/waf/main.tf"/>
		<testcase name="[NONE][CKV_AWS_342] Ensure WAF rule has any actions" classname="/modules/edge/waf/main.tf.module.waf.aws_wafv2_web_acl.this" file="/modules/edge/waf/main.tf"/>
		<testcase name="[NONE][CKV_AWS_41] Ensure no hard coded AWS access key and secret key exists in provider" classname="/provider.tf.aws.default" file="/provider.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_role.lambda_role" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV_AWS_57] S3 Bucket has an ACL defined which allows public WRITE access." classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_16] Ensure that Auto Scaling is enabled on your DynamoDB tables" classname="/modules/data/dynamodb/main.tf.module.usuarios_table.aws_dynamodb_table.this" file="/modules/data/dynamodb/main.tf"/>
		<testcase name="[NONE][CKV_AWS_20] S3 Bucket has an ACL defined which allows public READ access." classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_54] Ensure AWS CloudFront distribution is using secure SSL protocols for HTTPS communication" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV_AWS_19] Ensure all data stored in the S3 bucket is securely encrypted at rest" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_72] Ensure AWS CloudFront origin protocol policy enforces HTTPS-only" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.assume" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_iam_policy_document.policy" file="/modules/compute/lambda_usuarios/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_77] Ensure AWS API Gateway Rest API attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="/modules/api/api_gateway/main.tf.module.api_gateway.aws_apigatewayv2_api.this" file="/modules/api/api_gateway/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_46] Ensure AWS CloudFront Distribution with S3 have Origin Access set to enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf"/>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_cloudwatch_log_group.lambda_log_group" file="/modules/compute/lambda_usuarios/main.tf">
			<failure type="failure" message="Ensure that CloudWatch Log Group is encrypted by KMS">
Resource: module.lambda_usuarios.aws_cloudwatch_log_group.lambda_log_group
File: /modules/compute/lambda_usuarios/main.tf: 71-80
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms

		71 | resource &quot;aws_cloudwatch_log_group&quot; &quot;lambda_log_group&quot; {
		72 |   # checkov:skip=CKV_AWS_338: Retención definida en 14 días por política interna de Villa Alfredo
		73 |   name              = &quot;/aws/lambda/${var.function_name}&quot;
		74 |   retention_in_days = 14
		75 | 
		76 |   tags = {
		77 |     project     = &quot;Villa Alfredo&quot;
		78 |     environment = terraform.workspace
		79 |   }
		80 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: module.lambda_usuarios.aws_lambda_function.this
File: /modules/compute/lambda_usuarios/main.tf: 86-111
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		86  | resource &quot;aws_lambda_function&quot; &quot;this&quot; {
		87  |   function_name    = var.function_name
		88  |   role             = aws_iam_role.lambda_role.arn
		89  |   runtime          = var.runtime
		90  |   handler          = var.handler
		91  | 
		92  |   filename         = data.archive_file.zip.output_path
		93  |   source_code_hash = data.archive_file.zip.output_base64sha256
		94  | 
		95  |   memory_size      = var.memory_size
		96  |   timeout          = var.timeout
		97  | 
		98  |   environment {
		99  |     variables = {
		100 |       USERS_TABLE = var.dynamodb_table_name
		101 |     }
		102 |   }
		103 | 
		104 |   tags = {
		105 |     project     = &quot;Villa Alfredo&quot;
		106 |     environment = terraform.workspace
		107 |   }
		108 | 
		109 |   # Hacer referencia al Log Group ya creado en lugar de crear un ciclo
		110 |   depends_on = [aws_cloudwatch_log_group.lambda_log_group]
		111 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: module.lambda_usuarios.aws_lambda_function.this
File: /modules/compute/lambda_usuarios/main.tf: 86-111
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		86  | resource &quot;aws_lambda_function&quot; &quot;this&quot; {
		87  |   function_name    = var.function_name
		88  |   role             = aws_iam_role.lambda_role.arn
		89  |   runtime          = var.runtime
		90  |   handler          = var.handler
		91  | 
		92  |   filename         = data.archive_file.zip.output_path
		93  |   source_code_hash = data.archive_file.zip.output_base64sha256
		94  | 
		95  |   memory_size      = var.memory_size
		96  |   timeout          = var.timeout
		97  | 
		98  |   environment {
		99  |     variables = {
		100 |       USERS_TABLE = var.dynamodb_table_name
		101 |     }
		102 |   }
		103 | 
		104 |   tags = {
		105 |     project     = &quot;Villa Alfredo&quot;
		106 |     environment = terraform.workspace
		107 |   }
		108 | 
		109 |   # Hacer referencia al Log Group ya creado en lugar de crear un ciclo
		110 |   depends_on = [aws_cloudwatch_log_group.lambda_log_group]
		111 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: module.lambda_usuarios.aws_lambda_function.this
File: /modules/compute/lambda_usuarios/main.tf: 86-111
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		86  | resource &quot;aws_lambda_function&quot; &quot;this&quot; {
		87  |   function_name    = var.function_name
		88  |   role             = aws_iam_role.lambda_role.arn
		89  |   runtime          = var.runtime
		90  |   handler          = var.handler
		91  | 
		92  |   filename         = data.archive_file.zip.output_path
		93  |   source_code_hash = data.archive_file.zip.output_base64sha256
		94  | 
		95  |   memory_size      = var.memory_size
		96  |   timeout          = var.timeout
		97  | 
		98  |   environment {
		99  |     variables = {
		100 |       USERS_TABLE = var.dynamodb_table_name
		101 |     }
		102 |   }
		103 | 
		104 |   tags = {
		105 |     project     = &quot;Villa Alfredo&quot;
		106 |     environment = terraform.workspace
		107 |   }
		108 | 
		109 |   # Hacer referencia al Log Group ya creado en lugar de crear un ciclo
		110 |   depends_on = [aws_cloudwatch_log_group.lambda_log_group]
		111 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: module.lambda_usuarios.aws_lambda_function.this
File: /modules/compute/lambda_usuarios/main.tf: 86-111
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		86  | resource &quot;aws_lambda_function&quot; &quot;this&quot; {
		87  |   function_name    = var.function_name
		88  |   role             = aws_iam_role.lambda_role.arn
		89  |   runtime          = var.runtime
		90  |   handler          = var.handler
		91  | 
		92  |   filename         = data.archive_file.zip.output_path
		93  |   source_code_hash = data.archive_file.zip.output_base64sha256
		94  | 
		95  |   memory_size      = var.memory_size
		96  |   timeout          = var.timeout
		97  | 
		98  |   environment {
		99  |     variables = {
		100 |       USERS_TABLE = var.dynamodb_table_name
		101 |     }
		102 |   }
		103 | 
		104 |   tags = {
		105 |     project     = &quot;Villa Alfredo&quot;
		106 |     environment = terraform.workspace
		107 |   }
		108 | 
		109 |   # Hacer referencia al Log Group ya creado en lugar de crear un ciclo
		110 |   depends_on = [aws_cloudwatch_log_group.lambda_log_group]
		111 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: module.lambda_usuarios.aws_lambda_function.this
File: /modules/compute/lambda_usuarios/main.tf: 86-111
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		86  | resource &quot;aws_lambda_function&quot; &quot;this&quot; {
		87  |   function_name    = var.function_name
		88  |   role             = aws_iam_role.lambda_role.arn
		89  |   runtime          = var.runtime
		90  |   handler          = var.handler
		91  | 
		92  |   filename         = data.archive_file.zip.output_path
		93  |   source_code_hash = data.archive_file.zip.output_base64sha256
		94  | 
		95  |   memory_size      = var.memory_size
		96  |   timeout          = var.timeout
		97  | 
		98  |   environment {
		99  |     variables = {
		100 |       USERS_TABLE = var.dynamodb_table_name
		101 |     }
		102 |   }
		103 | 
		104 |   tags = {
		105 |     project     = &quot;Villa Alfredo&quot;
		106 |     environment = terraform.workspace
		107 |   }
		108 | 
		109 |   # Hacer referencia al Log Group ya creado en lugar de crear un ciclo
		110 |   depends_on = [aws_cloudwatch_log_group.lambda_log_group]
		111 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_lambda_function.this" file="/modules/compute/lambda_usuarios/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: module.lambda_usuarios.aws_lambda_function.this
File: /modules/compute/lambda_usuarios/main.tf: 86-111
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		86  | resource &quot;aws_lambda_function&quot; &quot;this&quot; {
		87  |   function_name    = var.function_name
		88  |   role             = aws_iam_role.lambda_role.arn
		89  |   runtime          = var.runtime
		90  |   handler          = var.handler
		91  | 
		92  |   filename         = data.archive_file.zip.output_path
		93  |   source_code_hash = data.archive_file.zip.output_base64sha256
		94  | 
		95  |   memory_size      = var.memory_size
		96  |   timeout          = var.timeout
		97  | 
		98  |   environment {
		99  |     variables = {
		100 |       USERS_TABLE = var.dynamodb_table_name
		101 |     }
		102 |   }
		103 | 
		104 |   tags = {
		105 |     project     = &quot;Villa Alfredo&quot;
		106 |     environment = terraform.workspace
		107 |   }
		108 | 
		109 |   # Hacer referencia al Log Group ya creado en lugar de crear un ciclo
		110 |   depends_on = [aws_cloudwatch_log_group.lambda_log_group]
		111 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_28] Ensure DynamoDB point in time recovery (backup) is enabled" classname="/modules/data/dynamodb/main.tf.module.usuarios_table.aws_dynamodb_table.this" file="/modules/data/dynamodb/main.tf">
			<failure type="failure" message="Ensure DynamoDB point in time recovery (backup) is enabled">
Resource: module.usuarios_table.aws_dynamodb_table.this
File: /modules/data/dynamodb/main.tf: 8-34
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6

		8  | resource &quot;aws_dynamodb_table&quot; &quot;this&quot; {
		9  |   name         = var.table_name
		10 |   billing_mode = var.billing_mode   # así no te preocupas por RCU/WCU
		11 | 
		12 |   hash_key     = var.hash_key
		13 | 
		14 |   # ---------- Atributos ----------
		15 |   attribute {
		16 |     name = var.hash_key
		17 |     type = &quot;S&quot;
		18 |   }
		19 | 
		20 |   # Agrega sort key solo si se definió
		21 |   dynamic &quot;attribute&quot; {
		22 |     for_each = local.use_sort_key ? [1] : []
		23 |     content {
		24 |       name = var.sort_key
		25 |       type = &quot;S&quot;
		26 |     }
		27 |   }
		28 | 
		29 |   # ---------- Etiquetas ----------
		30 |   tags = {
		31 |     project     = &quot;Villa Alfredo&quot;
		32 |     environment = terraform.workspace
		33 |   }
		34 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_119] Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK" classname="/modules/data/dynamodb/main.tf.module.usuarios_table.aws_dynamodb_table.this" file="/modules/data/dynamodb/main.tf">
			<failure type="failure" message="Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK">
Resource: module.usuarios_table.aws_dynamodb_table.this
File: /modules/data/dynamodb/main.tf: 8-34
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-52

		8  | resource &quot;aws_dynamodb_table&quot; &quot;this&quot; {
		9  |   name         = var.table_name
		10 |   billing_mode = var.billing_mode   # así no te preocupas por RCU/WCU
		11 | 
		12 |   hash_key     = var.hash_key
		13 | 
		14 |   # ---------- Atributos ----------
		15 |   attribute {
		16 |     name = var.hash_key
		17 |     type = &quot;S&quot;
		18 |   }
		19 | 
		20 |   # Agrega sort key solo si se definió
		21 |   dynamic &quot;attribute&quot; {
		22 |     for_each = local.use_sort_key ? [1] : []
		23 |     content {
		24 |       name = var.sort_key
		25 |       type = &quot;S&quot;
		26 |     }
		27 |   }
		28 | 
		29 |   # ---------- Etiquetas ----------
		30 |   tags = {
		31 |     project     = &quot;Villa Alfredo&quot;
		32 |     environment = terraform.workspace
		33 |   }
		34 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_374] Ensure AWS CloudFront web distribution has geo restriction enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure AWS CloudFront web distribution has geo restriction enabled">
Resource: module.s3_cloudfront.aws_cloudfront_distribution.cdn
File: /modules/edge/s3_cloudfront/main.tf: 14-87
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_310] Ensure CloudFront distributions should have origin failover configured" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure CloudFront distributions should have origin failover configured">
Resource: module.s3_cloudfront.aws_cloudfront_distribution.cdn
File: /modules/edge/s3_cloudfront/main.tf: 14-87
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_174] Verify CloudFront Distribution Viewer Certificate is using TLS v1.2" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Verify CloudFront Distribution Viewer Certificate is using TLS v1.2">
Resource: module.s3_cloudfront.aws_cloudfront_distribution.cdn
File: /modules/edge/s3_cloudfront/main.tf: 14-87
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-63

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_86] Ensure CloudFront distribution has Access Logging enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure CloudFront distribution has Access Logging enabled">
Resource: module.s3_cloudfront.aws_cloudfront_distribution.cdn
File: /modules/edge/s3_cloudfront/main.tf: 14-87
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-20

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_192] Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell" classname="/modules/edge/waf/main.tf.module.waf.aws_wafv2_web_acl.this" file="/modules/edge/waf/main.tf">
			<failure type="failure" message="Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell">
Resource: module.waf.aws_wafv2_web_acl.this
File: /modules/edge/waf/main.tf: 1-42
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-waf-prevents-message-lookup-in-log4j2

		1  | resource &quot;aws_wafv2_web_acl&quot; &quot;this&quot; {
		2  |   name        = &quot;villa-alfredo-waf&quot;
		3  |   description = &quot;WAF para proteger CloudFront&quot;
		4  |   scope       = &quot;CLOUDFRONT&quot;
		5  | 
		6  |   default_action {
		7  |     allow {}
		8  |   }
		9  | 
		10 |   rule {
		11 |     name     = &quot;block-bad-bots&quot;
		12 |     priority = 1
		13 | 
		14 |     statement {
		15 |       managed_rule_group_statement {
		16 |         name        = &quot;AWSManagedRulesCommonRuleSet&quot;
		17 |         vendor_name = &quot;AWS&quot;
		18 |       }
		19 |     }
		20 | 
		21 |     override_action {
		22 |       none {}
		23 |     }
		24 | 
		25 |     visibility_config {
		26 |       cloudwatch_metrics_enabled = true
		27 |       metric_name                = &quot;wafCommonRules&quot;
		28 |       sampled_requests_enabled   = true
		29 |     }
		30 |   }
		31 | 
		32 |   visibility_config {
		33 |     cloudwatch_metrics_enabled = true
		34 |     metric_name                = &quot;villaAlfredoWAF&quot;
		35 |     sampled_requests_enabled   = true
		36 |   }
		37 | 
		38 |   tags = {
		39 |     environment = var.environment
		40 |     project     = &quot;Villa Alfredo&quot;
		41 |   }
		42 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_21] Ensure all data stored in the S3 bucket have versioning enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure all data stored in the S3 bucket have versioning enabled">
Resource: module.s3_cloudfront.aws_s3_bucket.this
File: /modules/edge/s3_cloudfront/main.tf: 1-8
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning

		1 | resource &quot;aws_s3_bucket&quot; &quot;this&quot; {
		2 |   bucket = var.bucket_name
		3 | 
		4 |   tags = {
		5 |     project     = &quot;Villa Alfredo&quot;
		6 |     environment = &quot;dev&quot;
		7 |   }
		8 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_32] Ensure CloudFront distribution has a response headers policy attached" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure CloudFront distribution has a response headers policy attached">
Resource: module.s3_cloudfront.aws_cloudfront_distribution.cdn
File: /modules/edge/s3_cloudfront/main.tf: 14-87
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_42] Ensure AWS CloudFront distribution uses custom SSL certificate" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure AWS CloudFront distribution uses custom SSL certificate">
Resource: module.s3_cloudfront.aws_cloudfront_distribution.cdn
File: /modules/edge/s3_cloudfront/main.tf: 14-87
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-cloudfront-distribution-uses-custom-ssl-certificate

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_145] Ensure that S3 buckets are encrypted with KMS by default" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure that S3 buckets are encrypted with KMS by default">
Resource: module.s3_cloudfront.aws_s3_bucket.this
File: /modules/edge/s3_cloudfront/main.tf: 1-8
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		1 | resource &quot;aws_s3_bucket&quot; &quot;this&quot; {
		2 |   bucket = var.bucket_name
		3 | 
		4 |   tags = {
		5 |     project     = &quot;Villa Alfredo&quot;
		6 |     environment = &quot;dev&quot;
		7 |   }
		8 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_31] Ensure WAF2 has a Logging Configuration" classname="/modules/edge/waf/main.tf.module.waf.aws_wafv2_web_acl.this" file="/modules/edge/waf/main.tf">
			<failure type="failure" message="Ensure WAF2 has a Logging Configuration">
Resource: module.waf.aws_wafv2_web_acl.this
File: /modules/edge/waf/main.tf: 1-42
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-33

		1  | resource &quot;aws_wafv2_web_acl&quot; &quot;this&quot; {
		2  |   name        = &quot;villa-alfredo-waf&quot;
		3  |   description = &quot;WAF para proteger CloudFront&quot;
		4  |   scope       = &quot;CLOUDFRONT&quot;
		5  | 
		6  |   default_action {
		7  |     allow {}
		8  |   }
		9  | 
		10 |   rule {
		11 |     name     = &quot;block-bad-bots&quot;
		12 |     priority = 1
		13 | 
		14 |     statement {
		15 |       managed_rule_group_statement {
		16 |         name        = &quot;AWSManagedRulesCommonRuleSet&quot;
		17 |         vendor_name = &quot;AWS&quot;
		18 |       }
		19 |     }
		20 | 
		21 |     override_action {
		22 |       none {}
		23 |     }
		24 | 
		25 |     visibility_config {
		26 |       cloudwatch_metrics_enabled = true
		27 |       metric_name                = &quot;wafCommonRules&quot;
		28 |       sampled_requests_enabled   = true
		29 |     }
		30 |   }
		31 | 
		32 |   visibility_config {
		33 |     cloudwatch_metrics_enabled = true
		34 |     metric_name                = &quot;villaAlfredoWAF&quot;
		35 |     sampled_requests_enabled   = true
		36 |   }
		37 | 
		38 |   tags = {
		39 |     environment = var.environment
		40 |     project     = &quot;Villa Alfredo&quot;
		41 |   }
		42 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_61] Ensure that an S3 bucket has a lifecycle configuration" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure that an S3 bucket has a lifecycle configuration">
Resource: module.s3_cloudfront.aws_s3_bucket.this
File: /modules/edge/s3_cloudfront/main.tf: 1-8
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61

		1 | resource &quot;aws_s3_bucket&quot; &quot;this&quot; {
		2 |   bucket = var.bucket_name
		3 | 
		4 |   tags = {
		5 |     project     = &quot;Villa Alfredo&quot;
		6 |     environment = &quot;dev&quot;
		7 |   }
		8 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_6] Ensure that S3 bucket has a Public Access block" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure that S3 bucket has a Public Access block">
Resource: module.s3_cloudfront.aws_s3_bucket.this
File: /modules/edge/s3_cloudfront/main.tf: 1-8
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached

		1 | resource &quot;aws_s3_bucket&quot; &quot;this&quot; {
		2 |   bucket = var.bucket_name
		3 | 
		4 |   tags = {
		5 |     project     = &quot;Villa Alfredo&quot;
		6 |     environment = &quot;dev&quot;
		7 |   }
		8 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_144] Ensure that S3 bucket has cross-region replication enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure that S3 bucket has cross-region replication enabled">
Resource: module.s3_cloudfront.aws_s3_bucket.this
File: /modules/edge/s3_cloudfront/main.tf: 1-8
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled

		1 | resource &quot;aws_s3_bucket&quot; &quot;this&quot; {
		2 |   bucket = var.bucket_name
		3 | 
		4 |   tags = {
		5 |     project     = &quot;Villa Alfredo&quot;
		6 |     environment = &quot;dev&quot;
		7 |   }
		8 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_62] Ensure S3 buckets should have event notifications enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure S3 buckets should have event notifications enabled">
Resource: module.s3_cloudfront.aws_s3_bucket.this
File: /modules/edge/s3_cloudfront/main.tf: 1-8
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62

		1 | resource &quot;aws_s3_bucket&quot; &quot;this&quot; {
		2 |   bucket = var.bucket_name
		3 | 
		4 |   tags = {
		5 |     project     = &quot;Villa Alfredo&quot;
		6 |     environment = &quot;dev&quot;
		7 |   }
		8 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_47] Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_cloudfront_distribution.cdn" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability">
Resource: module.s3_cloudfront.aws_cloudfront_distribution.cdn
File: /modules/edge/s3_cloudfront/main.tf: 14-87
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_18] Ensure the S3 bucket has access logging enabled" classname="/modules/edge/s3_cloudfront/main.tf.module.s3_cloudfront.aws_s3_bucket.this" file="/modules/edge/s3_cloudfront/main.tf">
			<failure type="failure" message="Ensure the S3 bucket has access logging enabled">
Resource: module.s3_cloudfront.aws_s3_bucket.this
File: /modules/edge/s3_cloudfront/main.tf: 1-8
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging

		1 | resource &quot;aws_s3_bucket&quot; &quot;this&quot; {
		2 |   bucket = var.bucket_name
		3 | 
		4 |   tags = {
		5 |     project     = &quot;Villa Alfredo&quot;
		6 |     environment = &quot;dev&quot;
		7 |   }
		8 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="/modules/compute/lambda_usuarios/main.tf.module.lambda_usuarios.aws_cloudwatch_log_group.lambda_log_group" file="/modules/compute/lambda_usuarios/main.tf">
			<skipped type="skipped" message=" Retención definida en 14 días por política interna de Villa Alfredo"/>
		</testcase>
	</testsuite>
</testsuites>
